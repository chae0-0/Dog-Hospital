<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>메인 화면</title>
    <style>
        :root {
            --primary: #2d3436;
            --border: #b2bec3;
            --bg-color: #f5f6fa;
        }

        body { font-family: 'Pretendard', 'Malgun Gothic', sans-serif; background-color: var(--bg-color); margin: 0; padding: 30px; color: #222; }
        .container { max-width: 1400px; margin: 0 auto; }


        header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; background: white; padding: 25px; border-radius: 6px; border: 1px solid var(--border); }
        header h1 { margin: 0; font-size: 26px; font-weight: 800; color: var(--primary); letter-spacing: -0.5px; }

        .nav-group a { text-decoration: none; color: #555; font-size: 15px; font-weight: 700; padding: 12px 24px; border: 1px solid var(--border); background: white; transition: 0.2s; margin-left: -1px; }
        .nav-group a:first-child { border-radius: 6px 0 0 6px; }
        .nav-group a:last-child { border-radius: 0 6px 6px 0; }
        .nav-group a:hover { background: #2d3436; color: white; border-color: #2d3436; z-index: 1; position: relative; }

        /* 통계 */
        .stats-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 30px; }
        .stat-card { background: white; padding: 30px; border: 1px solid var(--border); border-top-width: 6px; box-shadow: 0 4px 6px rgba(0,0,0,0.04); border-radius: 4px; }

        .stat-card.dark { border-top-color: #2d3436; }
        .stat-card.medium { border-top-color: #636e72; }
        .stat-card.light { border-top-color: #b2bec3; }

        .stat-label { font-size: 15px; color: #666; font-weight: 700; margin-bottom: 12px; }
        .stat-value { font-size: 40px; font-weight: 900; color: var(--primary); letter-spacing: -1px; }
        .stat-unit { font-size: 18px; color: #999; font-weight: 500; margin-left: 5px; }


        .section { background: white; border: 1px solid var(--border); margin-bottom: 30px; border-radius: 4px; overflow: hidden; }
        .section-header { padding: 20px 25px; border-bottom: 1px solid var(--border); font-size: 18px; font-weight: 800; color: var(--primary); background-color: #fff; }


        table { width: 100%; border-collapse: collapse; font-size: 15px; }
        th { text-align: left; padding: 16px 25px; background-color: #f1f2f6; color: #555; font-weight: 800; border-bottom: 2px solid var(--border); }
        td { padding: 16px 25px; border-bottom: 1px solid #e1e1e1; color: #333; font-weight: 600; }
        tr:last-child td { border-bottom: none; }


        .badge {
            padding: 8px 0;
            width: 80px;
            text-align: center;
            border-radius: 4px;
            font-size: 13px;
            font-weight: 800;
            display: inline-block;
            color: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .badge-reserved { background-color: #273c75; }    /* 예약중: 파랑 */
        .badge-waiting { background-color: #dfe6e9; color: #2d3436; border: 1px solid #b2bec3; }  /* 대기중: 밝은회색 */
        .badge-inprogress { background-color: #c0392b; } /* 진료중: 빨강 */
        .badge-completed { background-color: #2d3436; }  /* 완료: 검정 */
    </style>
</head>
<body>
<div class="container">
    <header>
        <h1>강아지 동물병원</h1>
        <div class="nav-group">
            <a href="{% url 'reception_index' %}">원무/접수 데스크</a>
            <a href="{% url 'inventory_list' %}">자산 및 재고관리</a>
        </div>
    </header>

    <div class="stats-grid">
        <div class="stat-card dark">
            <span class="stat-label">금일 예약 및 방문</span>
            <span class="stat-value">{{ today_appointments.count }}<span class="stat-unit">건</span></span>
        </div>
        <div class="stat-card medium">
            <span class="stat-label">진료 완료</span>
            <span class="stat-value">{{ completed_count }}<span class="stat-unit">건</span></span>
        </div>
        <div class="stat-card light">
            <span class="stat-label">예상 매출액</span>
            <span class="stat-value">{{ total_sales }}<span class="stat-unit">원</span></span>
        </div>
    </div>

    <div class="section">
        <div class="section-header">진료 대기 환자 (접수 완료)</div>
        <table>
            <thead>
                <tr>
                    <th style="width: 15%;">예약시간</th>
                    <th style="width: 20%;">환자명</th>
                    <th style="width: 20%;">보호자</th>
                    <th>내원 사유</th>
                    <th style="width: 10%;">상태</th>
                </tr>
            </thead>
            <tbody>
                {% for appt in waiting_patients %}
                <tr>
                    <td>{{ appt.time }}</td>
                    <td><strong style="font-size:16px;">{{ appt.animal.name }}</strong> <span style="color:#777; font-size:13px; font-weight:500;">({{ appt.animal.breed }})</span></td>
                    <td>{{ appt.owner.name }}</td>
                    <td>{{ appt.reason }}</td>
                    <td><span class="badge badge-waiting">대기중</span></td>
                </tr>
                {% empty %}
                <tr><td colspan="5" style="text-align: center; color: #b2bec3; padding: 40px; font-weight: 500;">대기 중인 환자가 없습니다.</td></tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <div class="section">
        <div class="section-header">금일 전체 스케줄</div>
        <table>
            <thead>
                <tr>
                    <th style="width: 15%;">시간</th>
                    <th style="width: 20%;">환자명</th>
                    <th style="width: 20%;">담당 수의사</th>
                    <th>상태</th>
                </tr>
            </thead>
            <tbody>
                {% for appt in today_appointments %}
                <tr>
                    <td>{{ appt.time }}</td>
                    <td>{{ appt.animal.name }}</td>
                    <td>{{ appt.vet.name|default:"-" }}</td>
                    <td>
                        {% if appt.status == 'reserved' %}
                            <span class="badge badge-reserved">예약중</span>
                        {% elif appt.status == 'waiting' %}
                            <span class="badge badge-waiting">대기중</span>
                        {% elif appt.status == 'in_progress' %}
                            <span class="badge badge-inprogress">진료중</span>
                        {% elif appt.status == 'completed' %}
                            <span class="badge badge-completed">완료</span>
                        {% else %}
                            {{ appt.get_status_display }}
                        {% endif %}
                    </td>
                </tr>
                {% empty %}
                <tr><td colspan="4" style="text-align: center; color: #b2bec3; padding: 40px; font-weight: 500;">예약된 일정이 없습니다.</td></tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
</body>
</html>